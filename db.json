{"meta":{"version":1,"warehouse":"5.0.1"},"models":{"Asset":[{"_id":"source/CNAME","path":"CNAME","modified":1,"renderable":0}],"Cache":[{"_id":"source/CNAME","hash":"ab79680fc4903d86b6869157fbaca8ab2a8035d9","modified":1750670664496},{"_id":"source/_posts/hello-world.md","hash":"7d98d6592de80fdcd2949bd7401cec12afd98cdf","modified":1750670664497},{"_id":"source/_posts/pdf批量转图片.md","hash":"d3674a2f19c88a19bacbbcd414e3da10e8817b93","modified":1750672400834},{"_id":"public/search.json","hash":"f0bdd00a2dff7d87d37834c06a16653987f52eca","modified":1750734542771},{"_id":"public/2025/06/23/pdf批量转图片/index.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1750734542771},{"_id":"public/2025/06/23/hello-world/index.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1750734542771},{"_id":"public/archives/index.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1750734542771},{"_id":"public/archives/2025/index.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1750734542771},{"_id":"public/archives/2025/06/index.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1750734542771},{"_id":"public/index.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1750734542771},{"_id":"public/CNAME","hash":"ab79680fc4903d86b6869157fbaca8ab2a8035d9","modified":1750734542771}],"Category":[],"Data":[],"Page":[],"Post":[{"title":"Hello World","_content":"Welcome to [Hexo](https://hexo.io/)! This is your very first post. Check [documentation](https://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](https://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n\n## Quick Start\n\n### Create a new post\n\n``` bash\n$ hexo new \"My New Post\"\n```\n\nMore info: [Writing](https://hexo.io/docs/writing.html)\n\n### Run server\n\n``` bash\n$ hexo server\n```\n\nMore info: [Server](https://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\n$ hexo generate\n```\n\nMore info: [Generating](https://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\n$ hexo deploy\n```\n\nMore info: [Deployment](https://hexo.io/docs/one-command-deployment.html)\n","source":"_posts/hello-world.md","raw":"---\ntitle: Hello World\n---\nWelcome to [Hexo](https://hexo.io/)! This is your very first post. Check [documentation](https://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](https://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n\n## Quick Start\n\n### Create a new post\n\n``` bash\n$ hexo new \"My New Post\"\n```\n\nMore info: [Writing](https://hexo.io/docs/writing.html)\n\n### Run server\n\n``` bash\n$ hexo server\n```\n\nMore info: [Server](https://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\n$ hexo generate\n```\n\nMore info: [Generating](https://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\n$ hexo deploy\n```\n\nMore info: [Deployment](https://hexo.io/docs/one-command-deployment.html)\n","slug":"hello-world","published":1,"date":"2025-06-23T09:24:24.497Z","updated":"2025-06-23T09:24:24.497Z","comments":1,"layout":"post","photos":[],"_id":"cmc9y57cm0000v4kr3arl4x6w","content":"<p>Welcome to <a href=\"https://hexo.io/\">Hexo</a>! This is your very first post. Check <a href=\"https://hexo.io/docs/\">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href=\"https://hexo.io/docs/troubleshooting.html\">troubleshooting</a> or you can ask me on <a href=\"https://github.com/hexojs/hexo/issues\">GitHub</a>.</p>\n<h2 id=\"Quick-Start\"><a href=\"#Quick-Start\" class=\"headerlink\" title=\"Quick Start\"></a>Quick Start</h2><h3 id=\"Create-a-new-post\"><a href=\"#Create-a-new-post\" class=\"headerlink\" title=\"Create a new post\"></a>Create a new post</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo new <span class=\"string\">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/writing.html\">Writing</a></p>\n<h3 id=\"Run-server\"><a href=\"#Run-server\" class=\"headerlink\" title=\"Run server\"></a>Run server</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo server</span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/server.html\">Server</a></p>\n<h3 id=\"Generate-static-files\"><a href=\"#Generate-static-files\" class=\"headerlink\" title=\"Generate static files\"></a>Generate static files</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo generate</span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/generating.html\">Generating</a></p>\n<h3 id=\"Deploy-to-remote-sites\"><a href=\"#Deploy-to-remote-sites\" class=\"headerlink\" title=\"Deploy to remote sites\"></a>Deploy to remote sites</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo deploy</span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/one-command-deployment.html\">Deployment</a></p>\n","excerpt":"","more":"<p>Welcome to <a href=\"https://hexo.io/\">Hexo</a>! This is your very first post. Check <a href=\"https://hexo.io/docs/\">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href=\"https://hexo.io/docs/troubleshooting.html\">troubleshooting</a> or you can ask me on <a href=\"https://github.com/hexojs/hexo/issues\">GitHub</a>.</p>\n<h2 id=\"Quick-Start\"><a href=\"#Quick-Start\" class=\"headerlink\" title=\"Quick Start\"></a>Quick Start</h2><h3 id=\"Create-a-new-post\"><a href=\"#Create-a-new-post\" class=\"headerlink\" title=\"Create a new post\"></a>Create a new post</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo new <span class=\"string\">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/writing.html\">Writing</a></p>\n<h3 id=\"Run-server\"><a href=\"#Run-server\" class=\"headerlink\" title=\"Run server\"></a>Run server</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo server</span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/server.html\">Server</a></p>\n<h3 id=\"Generate-static-files\"><a href=\"#Generate-static-files\" class=\"headerlink\" title=\"Generate static files\"></a>Generate static files</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo generate</span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/generating.html\">Generating</a></p>\n<h3 id=\"Deploy-to-remote-sites\"><a href=\"#Deploy-to-remote-sites\" class=\"headerlink\" title=\"Deploy to remote sites\"></a>Deploy to remote sites</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo deploy</span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/one-command-deployment.html\">Deployment</a></p>\n"},{"title":"pdf批量转图片","date":"2025-06-23T09:52:44.000Z","_content":"\n## 遇到一个需求，要求弹窗展示政策pdf内容，为了方便，文件直接放在前端项目中。由于pdf文件体积较大，且仅需展示其内容，故决定将pdf转成图片放在项目中，以缩小文件体积\n\n### 解决方案：使用 [ImageMagick](https://www.imagemagick.org/) + [Ghostscript](https://www.ghostscript.com/) 处理pdf文件\n\n```bat\n@echo off\nsetlocal enabledelayedexpansion\n\n:: 设置目标 DPI，调整这里即可改变分辨率\nset dpi=150\n\n:: 设置输出图片的质量（范围：1-100）\nset quality=80\n\n:: 定义 A4 的实际尺寸（单位：英寸）\nset a4_width_inch=8.27\nset a4_height_inch=11.69\n\n:: 使用 PowerShell 动态计算 A4 分辨率（宽度和高度）\nfor /f \"tokens=*\" %%A in ('powershell -Command \"[math]::Round(%a4_width_inch% * %dpi%)\"') do set width=%%A\nfor /f \"tokens=*\" %%A in ('powershell -Command \"[math]::Round(%a4_height_inch% * %dpi%)\"') do set height=%%A\n\n:: 输出宽高以及质量参数以供验证\necho DPI: %dpi%\necho Width: %width% pixels\necho Height: %height% pixels\necho Quality: %quality%%\n\n:: 验证宽高是否正确\nif \"%width%\"==\"\" (\n    echo 宽度计算失败，请检查 PowerShell 是否可用或计算逻辑是否正确。\n    pause\n    exit /b\n)\nif \"%height%\"==\"\" (\n    echo 高度计算失败，请检查 PowerShell 是否可用或计算逻辑是否正确。\n    pause\n    exit /b\n)\n\n:: 遍历当前目录中的所有 PDF 文件\nfor %%f in (*.pdf) do (\n    :: 获取文件名（不带扩展名）\n    set filename=%%~nf\n    :: 创建与 PDF 同名的输出目录\n    mkdir \"!filename!\"\n    :: 转换 PDF 为图片，确保背景为白色，大小统一，设置质量\n    magick -density %dpi% \"%%f\" -background white -alpha remove -alpha off -resize %width%x%height% -gravity center -extent %width%x%height% -quality %quality% \"!filename!\\page-%%d.webp\"\n)\n\npause\n\n```\n","source":"_posts/pdf批量转图片.md","raw":"---\ntitle: pdf批量转图片\ndate: 2025-06-23 17:52:44\ntags:\n---\n\n## 遇到一个需求，要求弹窗展示政策pdf内容，为了方便，文件直接放在前端项目中。由于pdf文件体积较大，且仅需展示其内容，故决定将pdf转成图片放在项目中，以缩小文件体积\n\n### 解决方案：使用 [ImageMagick](https://www.imagemagick.org/) + [Ghostscript](https://www.ghostscript.com/) 处理pdf文件\n\n```bat\n@echo off\nsetlocal enabledelayedexpansion\n\n:: 设置目标 DPI，调整这里即可改变分辨率\nset dpi=150\n\n:: 设置输出图片的质量（范围：1-100）\nset quality=80\n\n:: 定义 A4 的实际尺寸（单位：英寸）\nset a4_width_inch=8.27\nset a4_height_inch=11.69\n\n:: 使用 PowerShell 动态计算 A4 分辨率（宽度和高度）\nfor /f \"tokens=*\" %%A in ('powershell -Command \"[math]::Round(%a4_width_inch% * %dpi%)\"') do set width=%%A\nfor /f \"tokens=*\" %%A in ('powershell -Command \"[math]::Round(%a4_height_inch% * %dpi%)\"') do set height=%%A\n\n:: 输出宽高以及质量参数以供验证\necho DPI: %dpi%\necho Width: %width% pixels\necho Height: %height% pixels\necho Quality: %quality%%\n\n:: 验证宽高是否正确\nif \"%width%\"==\"\" (\n    echo 宽度计算失败，请检查 PowerShell 是否可用或计算逻辑是否正确。\n    pause\n    exit /b\n)\nif \"%height%\"==\"\" (\n    echo 高度计算失败，请检查 PowerShell 是否可用或计算逻辑是否正确。\n    pause\n    exit /b\n)\n\n:: 遍历当前目录中的所有 PDF 文件\nfor %%f in (*.pdf) do (\n    :: 获取文件名（不带扩展名）\n    set filename=%%~nf\n    :: 创建与 PDF 同名的输出目录\n    mkdir \"!filename!\"\n    :: 转换 PDF 为图片，确保背景为白色，大小统一，设置质量\n    magick -density %dpi% \"%%f\" -background white -alpha remove -alpha off -resize %width%x%height% -gravity center -extent %width%x%height% -quality %quality% \"!filename!\\page-%%d.webp\"\n)\n\npause\n\n```\n","slug":"pdf批量转图片","published":1,"updated":"2025-06-23T09:53:20.834Z","comments":1,"layout":"post","photos":[],"_id":"cmc9y57cp0001v4krdou27zf9","content":"<h2 id=\"遇到一个需求，要求弹窗展示政策pdf内容，为了方便，文件直接放在前端项目中。由于pdf文件体积较大，且仅需展示其内容，故决定将pdf转成图片放在项目中，以缩小文件体积\"><a href=\"#遇到一个需求，要求弹窗展示政策pdf内容，为了方便，文件直接放在前端项目中。由于pdf文件体积较大，且仅需展示其内容，故决定将pdf转成图片放在项目中，以缩小文件体积\" class=\"headerlink\" title=\"遇到一个需求，要求弹窗展示政策pdf内容，为了方便，文件直接放在前端项目中。由于pdf文件体积较大，且仅需展示其内容，故决定将pdf转成图片放在项目中，以缩小文件体积\"></a>遇到一个需求，要求弹窗展示政策pdf内容，为了方便，文件直接放在前端项目中。由于pdf文件体积较大，且仅需展示其内容，故决定将pdf转成图片放在项目中，以缩小文件体积</h2><h3 id=\"解决方案：使用-ImageMagick-Ghostscript-处理pdf文件\"><a href=\"#解决方案：使用-ImageMagick-Ghostscript-处理pdf文件\" class=\"headerlink\" title=\"解决方案：使用 ImageMagick + Ghostscript 处理pdf文件\"></a>解决方案：使用 <a href=\"https://www.imagemagick.org/\">ImageMagick</a> + <a href=\"https://www.ghostscript.com/\">Ghostscript</a> 处理pdf文件</h3><figure class=\"highlight bat\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@<span class=\"built_in\">echo</span> off</span><br><span class=\"line\"><span class=\"built_in\">setlocal</span> enabledelayedexpansion</span><br><span class=\"line\"></span><br><span class=\"line\">:: 设置目标 DPI，调整这里即可改变分辨率</span><br><span class=\"line\"><span class=\"built_in\">set</span> dpi=<span class=\"number\">150</span></span><br><span class=\"line\"></span><br><span class=\"line\">:: 设置输出图片的质量（范围：<span class=\"number\">1</span>-<span class=\"number\">100</span>）</span><br><span class=\"line\"><span class=\"built_in\">set</span> quality=<span class=\"number\">80</span></span><br><span class=\"line\"></span><br><span class=\"line\">:: 定义 A4 的实际尺寸（单位：英寸）</span><br><span class=\"line\"><span class=\"built_in\">set</span> a4_width_inch=<span class=\"number\">8</span>.<span class=\"number\">27</span></span><br><span class=\"line\"><span class=\"built_in\">set</span> a4_height_inch=<span class=\"number\">11</span>.<span class=\"number\">69</span></span><br><span class=\"line\"></span><br><span class=\"line\">:: 使用 PowerShell 动态计算 A4 分辨率（宽度和高度）</span><br><span class=\"line\"><span class=\"keyword\">for</span> /f &quot;tokens=*&quot; <span class=\"variable\">%%A</span> <span class=\"keyword\">in</span> (&#x27;powershell -Command &quot;[math]::Round(<span class=\"variable\">%a4_width_inch%</span> * <span class=\"variable\">%dpi%</span>)&quot;&#x27;) <span class=\"keyword\">do</span> <span class=\"built_in\">set</span> width=<span class=\"variable\">%%A</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> /f &quot;tokens=*&quot; <span class=\"variable\">%%A</span> <span class=\"keyword\">in</span> (&#x27;powershell -Command &quot;[math]::Round(<span class=\"variable\">%a4_height_inch%</span> * <span class=\"variable\">%dpi%</span>)&quot;&#x27;) <span class=\"keyword\">do</span> <span class=\"built_in\">set</span> height=<span class=\"variable\">%%A</span></span><br><span class=\"line\"></span><br><span class=\"line\">:: 输出宽高以及质量参数以供验证</span><br><span class=\"line\"><span class=\"built_in\">echo</span> DPI: <span class=\"variable\">%dpi%</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> Width: <span class=\"variable\">%width%</span> pixels</span><br><span class=\"line\"><span class=\"built_in\">echo</span> Height: <span class=\"variable\">%height%</span> pixels</span><br><span class=\"line\"><span class=\"built_in\">echo</span> Quality: <span class=\"variable\">%quality%</span>%</span><br><span class=\"line\"></span><br><span class=\"line\">:: 验证宽高是否正确</span><br><span class=\"line\"><span class=\"keyword\">if</span> &quot;<span class=\"variable\">%width%</span>&quot;==&quot;&quot; (</span><br><span class=\"line\">    <span class=\"built_in\">echo</span> 宽度计算失败，请检查 PowerShell 是否可用或计算逻辑是否正确。</span><br><span class=\"line\">    <span class=\"built_in\">pause</span></span><br><span class=\"line\">    <span class=\"keyword\">exit</span> /b</span><br><span class=\"line\">)</span><br><span class=\"line\"><span class=\"keyword\">if</span> &quot;<span class=\"variable\">%height%</span>&quot;==&quot;&quot; (</span><br><span class=\"line\">    <span class=\"built_in\">echo</span> 高度计算失败，请检查 PowerShell 是否可用或计算逻辑是否正确。</span><br><span class=\"line\">    <span class=\"built_in\">pause</span></span><br><span class=\"line\">    <span class=\"keyword\">exit</span> /b</span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\">:: 遍历当前目录中的所有 PDF 文件</span><br><span class=\"line\"><span class=\"keyword\">for</span> <span class=\"variable\">%%f</span> <span class=\"keyword\">in</span> (*.pdf) <span class=\"keyword\">do</span> (</span><br><span class=\"line\">    :: 获取文件名（不带扩展名）</span><br><span class=\"line\">    <span class=\"built_in\">set</span> filename=<span class=\"variable\">%%~</span>nf</span><br><span class=\"line\">    :: 创建与 PDF 同名的输出目录</span><br><span class=\"line\">    <span class=\"built_in\">mkdir</span> &quot;<span class=\"variable\">!filename!</span>&quot;</span><br><span class=\"line\">    :: 转换 PDF 为图片，确保背景为白色，大小统一，设置质量</span><br><span class=\"line\">    magick -density <span class=\"variable\">%dpi%</span> &quot;<span class=\"variable\">%%f</span>&quot; -background white -alpha remove -alpha off -resize <span class=\"variable\">%width%</span>x<span class=\"variable\">%height%</span> -gravity center -extent <span class=\"variable\">%width%</span>x<span class=\"variable\">%height%</span> -quality <span class=\"variable\">%quality%</span> &quot;<span class=\"variable\">!filename!</span>\\page-<span class=\"variable\">%%d</span>.webp&quot;</span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">pause</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n","excerpt":"","more":"<h2 id=\"遇到一个需求，要求弹窗展示政策pdf内容，为了方便，文件直接放在前端项目中。由于pdf文件体积较大，且仅需展示其内容，故决定将pdf转成图片放在项目中，以缩小文件体积\"><a href=\"#遇到一个需求，要求弹窗展示政策pdf内容，为了方便，文件直接放在前端项目中。由于pdf文件体积较大，且仅需展示其内容，故决定将pdf转成图片放在项目中，以缩小文件体积\" class=\"headerlink\" title=\"遇到一个需求，要求弹窗展示政策pdf内容，为了方便，文件直接放在前端项目中。由于pdf文件体积较大，且仅需展示其内容，故决定将pdf转成图片放在项目中，以缩小文件体积\"></a>遇到一个需求，要求弹窗展示政策pdf内容，为了方便，文件直接放在前端项目中。由于pdf文件体积较大，且仅需展示其内容，故决定将pdf转成图片放在项目中，以缩小文件体积</h2><h3 id=\"解决方案：使用-ImageMagick-Ghostscript-处理pdf文件\"><a href=\"#解决方案：使用-ImageMagick-Ghostscript-处理pdf文件\" class=\"headerlink\" title=\"解决方案：使用 ImageMagick + Ghostscript 处理pdf文件\"></a>解决方案：使用 <a href=\"https://www.imagemagick.org/\">ImageMagick</a> + <a href=\"https://www.ghostscript.com/\">Ghostscript</a> 处理pdf文件</h3><figure class=\"highlight bat\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@<span class=\"built_in\">echo</span> off</span><br><span class=\"line\"><span class=\"built_in\">setlocal</span> enabledelayedexpansion</span><br><span class=\"line\"></span><br><span class=\"line\">:: 设置目标 DPI，调整这里即可改变分辨率</span><br><span class=\"line\"><span class=\"built_in\">set</span> dpi=<span class=\"number\">150</span></span><br><span class=\"line\"></span><br><span class=\"line\">:: 设置输出图片的质量（范围：<span class=\"number\">1</span>-<span class=\"number\">100</span>）</span><br><span class=\"line\"><span class=\"built_in\">set</span> quality=<span class=\"number\">80</span></span><br><span class=\"line\"></span><br><span class=\"line\">:: 定义 A4 的实际尺寸（单位：英寸）</span><br><span class=\"line\"><span class=\"built_in\">set</span> a4_width_inch=<span class=\"number\">8</span>.<span class=\"number\">27</span></span><br><span class=\"line\"><span class=\"built_in\">set</span> a4_height_inch=<span class=\"number\">11</span>.<span class=\"number\">69</span></span><br><span class=\"line\"></span><br><span class=\"line\">:: 使用 PowerShell 动态计算 A4 分辨率（宽度和高度）</span><br><span class=\"line\"><span class=\"keyword\">for</span> /f &quot;tokens=*&quot; <span class=\"variable\">%%A</span> <span class=\"keyword\">in</span> (&#x27;powershell -Command &quot;[math]::Round(<span class=\"variable\">%a4_width_inch%</span> * <span class=\"variable\">%dpi%</span>)&quot;&#x27;) <span class=\"keyword\">do</span> <span class=\"built_in\">set</span> width=<span class=\"variable\">%%A</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> /f &quot;tokens=*&quot; <span class=\"variable\">%%A</span> <span class=\"keyword\">in</span> (&#x27;powershell -Command &quot;[math]::Round(<span class=\"variable\">%a4_height_inch%</span> * <span class=\"variable\">%dpi%</span>)&quot;&#x27;) <span class=\"keyword\">do</span> <span class=\"built_in\">set</span> height=<span class=\"variable\">%%A</span></span><br><span class=\"line\"></span><br><span class=\"line\">:: 输出宽高以及质量参数以供验证</span><br><span class=\"line\"><span class=\"built_in\">echo</span> DPI: <span class=\"variable\">%dpi%</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> Width: <span class=\"variable\">%width%</span> pixels</span><br><span class=\"line\"><span class=\"built_in\">echo</span> Height: <span class=\"variable\">%height%</span> pixels</span><br><span class=\"line\"><span class=\"built_in\">echo</span> Quality: <span class=\"variable\">%quality%</span>%</span><br><span class=\"line\"></span><br><span class=\"line\">:: 验证宽高是否正确</span><br><span class=\"line\"><span class=\"keyword\">if</span> &quot;<span class=\"variable\">%width%</span>&quot;==&quot;&quot; (</span><br><span class=\"line\">    <span class=\"built_in\">echo</span> 宽度计算失败，请检查 PowerShell 是否可用或计算逻辑是否正确。</span><br><span class=\"line\">    <span class=\"built_in\">pause</span></span><br><span class=\"line\">    <span class=\"keyword\">exit</span> /b</span><br><span class=\"line\">)</span><br><span class=\"line\"><span class=\"keyword\">if</span> &quot;<span class=\"variable\">%height%</span>&quot;==&quot;&quot; (</span><br><span class=\"line\">    <span class=\"built_in\">echo</span> 高度计算失败，请检查 PowerShell 是否可用或计算逻辑是否正确。</span><br><span class=\"line\">    <span class=\"built_in\">pause</span></span><br><span class=\"line\">    <span class=\"keyword\">exit</span> /b</span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\">:: 遍历当前目录中的所有 PDF 文件</span><br><span class=\"line\"><span class=\"keyword\">for</span> <span class=\"variable\">%%f</span> <span class=\"keyword\">in</span> (*.pdf) <span class=\"keyword\">do</span> (</span><br><span class=\"line\">    :: 获取文件名（不带扩展名）</span><br><span class=\"line\">    <span class=\"built_in\">set</span> filename=<span class=\"variable\">%%~</span>nf</span><br><span class=\"line\">    :: 创建与 PDF 同名的输出目录</span><br><span class=\"line\">    <span class=\"built_in\">mkdir</span> &quot;<span class=\"variable\">!filename!</span>&quot;</span><br><span class=\"line\">    :: 转换 PDF 为图片，确保背景为白色，大小统一，设置质量</span><br><span class=\"line\">    magick -density <span class=\"variable\">%dpi%</span> &quot;<span class=\"variable\">%%f</span>&quot; -background white -alpha remove -alpha off -resize <span class=\"variable\">%width%</span>x<span class=\"variable\">%height%</span> -gravity center -extent <span class=\"variable\">%width%</span>x<span class=\"variable\">%height%</span> -quality <span class=\"variable\">%quality%</span> &quot;<span class=\"variable\">!filename!</span>\\page-<span class=\"variable\">%%d</span>.webp&quot;</span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">pause</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n"}],"PostAsset":[],"PostCategory":[],"PostTag":[],"Tag":[]}}